2025-07-10 08:53:29.502 -03:00 [INF] Sistema iniciado em 10/07/2025 08:53:29
2025-07-10 08:53:29.567 -03:00 [INF] Creating key {0c434f62-133c-4e49-83fd-aee087480d56} with creation date 2025-07-10 11:53:29Z, activation date 2025-07-10 11:53:29Z, and expiration date 2025-10-08 11:53:29Z.
2025-07-10 08:53:29.578 -03:00 [WRN] No XML encryptor configured. Key {0c434f62-133c-4e49-83fd-aee087480d56} may be persisted to storage in unencrypted form.
2025-07-10 08:53:29.581 -03:00 [INF] Writing data to file 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\DataProtection-Keys\key-0c434f62-133c-4e49-83fd-aee087480d56.xml'.
2025-07-10 08:53:29.620 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 08:53:29.622 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 08:53:29.623 -03:00 [INF] Hosting environment: Development
2025-07-10 08:53:29.624 -03:00 [INF] Content root path: F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 08:53:33.518 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-07-10 08:53:33.562 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev)'
2025-07-10 08:53:33.583 -03:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller site.diogocosta.dev.Controllers.HomeController (site.diogocosta.dev).
2025-07-10 08:53:33.598 -03:00 [INF] Executing ViewResult, running view Index.
2025-07-10 08:53:33.715 -03:00 [INF] Executed ViewResult - view Index executed in 118.0082ms.
2025-07-10 08:53:33.726 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev) in 140.4849ms
2025-07-10 08:53:33.727 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev)'
2025-07-10 08:53:33.730 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 213.7114ms
2025-07-10 08:53:33.751 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/IMG_0045.webp - null null
2025-07-10 08:53:33.751 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/newsletter.js - null null
2025-07-10 08:53:33.770 -03:00 [INF] Sending file. Request path: '/js/newsletter.js'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\js\newsletter.js'
2025-07-10 08:53:33.770 -03:00 [INF] Sending file. Request path: '/img/IMG_0045.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\IMG_0045.webp'
2025-07-10 08:53:33.774 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/newsletter.js - 200 5883 text/javascript 22.7221ms
2025-07-10 08:53:33.775 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/IMG_0045.webp - 200 43926 image/webp 24.8485ms
2025-07-10 08:53:34.150 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/1.webp - null null
2025-07-10 08:53:34.151 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/6.webp - null null
2025-07-10 08:53:34.154 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/3.webp - null null
2025-07-10 08:53:34.154 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/4.webp - null null
2025-07-10 08:53:34.155 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/5.webp - null null
2025-07-10 08:53:34.155 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/7.webp - null null
2025-07-10 08:53:34.156 -03:00 [INF] Sending file. Request path: '/img/1.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\1.webp'
2025-07-10 08:53:34.158 -03:00 [INF] Sending file. Request path: '/img/6.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\6.webp'
2025-07-10 08:53:34.161 -03:00 [INF] Sending file. Request path: '/img/3.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\3.webp'
2025-07-10 08:53:34.164 -03:00 [INF] Sending file. Request path: '/img/4.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\4.webp'
2025-07-10 08:53:34.167 -03:00 [INF] Sending file. Request path: '/img/5.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\5.webp'
2025-07-10 08:53:34.169 -03:00 [INF] Sending file. Request path: '/img/7.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\7.webp'
2025-07-10 08:53:34.170 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/1.webp - 200 6562 image/webp 19.4673ms
2025-07-10 08:53:34.171 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/6.webp - 200 7306 image/webp 20.8428ms
2025-07-10 08:53:34.173 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/3.webp - 200 4492 image/webp 19.1465ms
2025-07-10 08:53:34.174 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/4.webp - 200 8996 image/webp 20.1847ms
2025-07-10 08:53:34.175 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/5.webp - 200 8740 image/webp 20.1123ms
2025-07-10 08:53:34.176 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/7.webp - 200 4522 image/webp 21.0809ms
2025-07-10 08:53:34.178 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/8.webp - null null
2025-07-10 08:53:34.181 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/9.webp - null null
2025-07-10 08:53:34.182 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/11.webp - null null
2025-07-10 08:53:34.184 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/14.webp - null null
2025-07-10 08:53:34.187 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/10.webp - null null
2025-07-10 08:53:34.190 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/12.webp - null null
2025-07-10 08:53:34.194 -03:00 [INF] Sending file. Request path: '/img/8.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\8.webp'
2025-07-10 08:53:34.209 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/8.webp - 200 11264 image/webp 30.7515ms
2025-07-10 08:53:34.201 -03:00 [INF] Sending file. Request path: '/img/11.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\11.webp'
2025-07-10 08:53:34.202 -03:00 [INF] Sending file. Request path: '/img/14.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\14.webp'
2025-07-10 08:53:34.205 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/manifest.json?v=4 - null null
2025-07-10 08:53:34.205 -03:00 [INF] Sending file. Request path: '/img/10.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\10.webp'
2025-07-10 08:53:34.208 -03:00 [INF] Sending file. Request path: '/img/12.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\12.webp'
2025-07-10 08:53:34.197 -03:00 [INF] Sending file. Request path: '/img/9.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\9.webp'
2025-07-10 08:53:34.213 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/13.webp - null null
2025-07-10 08:53:34.215 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/11.webp - 200 5346 image/webp 32.6977ms
2025-07-10 08:53:34.217 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/14.webp - 200 7290 image/webp 32.5197ms
2025-07-10 08:53:34.222 -03:00 [INF] Sending file. Request path: '/manifest.json'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\manifest.json'
2025-07-10 08:53:34.223 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/10.webp - 200 7788 image/webp 36.3292ms
2025-07-10 08:53:34.225 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/12.webp - 200 4880 image/webp 34.7563ms
2025-07-10 08:53:34.227 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/9.webp - 200 13526 image/webp 46.4805ms
2025-07-10 08:53:34.231 -03:00 [INF] Sending file. Request path: '/img/13.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\13.webp'
2025-07-10 08:53:34.240 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/manifest.json?v=4 - 200 646 application/json 35.6609ms
2025-07-10 08:53:34.247 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/D_180.png - null null
2025-07-10 08:53:34.251 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/13.webp - 200 9486 image/webp 37.2171ms
2025-07-10 08:53:34.256 -03:00 [INF] Sending file. Request path: '/img/D_180.png'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\D_180.png'
2025-07-10 08:53:34.260 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/D_180.png - 200 3792 image/png 12.9729ms
2025-07-10 08:53:36.328 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/desbloqueio - null null
2025-07-10 08:53:36.331 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Index (site.diogocosta.dev)'
2025-07-10 08:53:36.333 -03:00 [INF] Route matched with {action = "Index", controller = "Desbloqueio"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 08:53:36.660 -03:00 [INF] Executing ViewResult, running view Index.
2025-07-10 08:53:36.682 -03:00 [INF] Executed ViewResult - view Index executed in 22.6489ms.
2025-07-10 08:53:36.683 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Index (site.diogocosta.dev) in 349.0562ms
2025-07-10 08:53:36.684 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Index (site.diogocosta.dev)'
2025-07-10 08:53:36.688 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/desbloqueio - 200 null text/html; charset=utf-8 359.6015ms
2025-07-10 08:53:54.638 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - application/x-www-form-urlencoded 228
2025-07-10 08:53:54.642 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 08:53:54.648 -03:00 [INF] Route matched with {action = "Cadastrar", controller = "Desbloqueio"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Cadastrar(site.diogocosta.dev.Models.DesbloqueioModel) on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 08:53:54.669 -03:00 [INF] 🔄 INICIANDO PROCESSO DE CADASTRO - Email: diogo@codigocentral.com.br, Nome: Diogo
2025-07-10 08:53:54.678 -03:00 [INF] 🔍 DADOS CAPTURADOS - IP: ::1, UserAgent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
2025-07-10 08:53:54.679 -03:00 [INF] 🔍 UTM PARAMETERS - Source: , Medium: , Campaign: 
2025-07-10 08:53:54.680 -03:00 [INF] 🚀 CHAMANDO _leadService.CriarLeadAsync - Email: diogo@codigocentral.com.br, Slug: manual-primeira-virada
2025-07-10 08:53:55.222 -03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-10 08:53:57.896 -03:00 [INF] Executed DbCommand (300ms) [Parameters=[@__ToLower_0='diogo@codigocentral.com.br', @__desafioSlug_1='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.created_at, l.desafio_slug, l.email, l.ip_address, l.nome, l.notas, l.opt_in, l.source_id, l.status, l.tags, l.updated_at, l.user_agent, l.utm_campaign, l.utm_content, l.utm_medium, l.utm_source, l.utm_term, l0.id, l0.ativo, l0.created_at, l0.descricao, l0.nome, l0.slug, l0.updated_at
FROM leads_system.leads AS l
LEFT JOIN leads_system.lead_sources AS l0 ON l.source_id = l0.id
WHERE l.email = @__ToLower_0 AND l.desafio_slug = @__desafioSlug_1
LIMIT 1
2025-07-10 08:53:58.239 -03:00 [INF] Executed DbCommand (267ms) [Parameters=[@__8__locals1_request_DesafioSlug_0='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.ativo, l.created_at, l.descricao, l.nome, l.slug, l.updated_at
FROM leads_system.lead_sources AS l
WHERE l.slug = @__8__locals1_request_DesafioSlug_0
LIMIT 1
2025-07-10 08:53:58.650 -03:00 [ERR] Failed executing DbCommand (268ms) [Parameters=[@p0='2025-07-10T11:53:58.3425349Z' (DbType = DateTime), @p1='manual-primeira-virada' (Nullable = false), @p2='diogo@codigocentral.com.br' (Nullable = false), @p3='::1', @p4='Diogo' (Nullable = false), @p5=NULL, @p6='True', @p7='9' (Nullable = true), @p8='novo' (Nullable = false), @p9=NULL (DbType = Object), @p10='2025-07-10T11:53:58.3425580Z' (DbType = DateTime), @p11='Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', @p12=NULL, @p13=NULL, @p14=NULL, @p15=NULL, @p16=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.leads (created_at, desafio_slug, email, ip_address, nome, notas, opt_in, source_id, status, tags, updated_at, user_agent, utm_campaign, utm_content, utm_medium, utm_source, utm_term)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16)
RETURNING id;
2025-07-10 08:53:58.665 -03:00 [ERR] An exception occurred in the database while saving changes for context type 'site.diogocosta.dev.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "ip_address" is of type inet but expression is of type text

POSITION: 230
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "ip_address" is of type inet but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 230
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "ip_address" is of type inet but expression is of type text

POSITION: 230
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "ip_address" is of type inet but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 230
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-10 08:53:58.691 -03:00 [ERR] Erro ao criar lead: diogo@codigocentral.com.br para manual-primeira-virada
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "ip_address" is of type inet but expression is of type text

POSITION: 230
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "ip_address" is of type inet but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 230
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at site.diogocosta.dev.Data.ApplicationDbContext.SaveChangesAsync(CancellationToken cancellationToken) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Data\ApplicationDbContext.cs:line 199
   at site.diogocosta.dev.Servicos.LeadService.CriarLeadAsync(CriarLeadRequest request, String ipAddress, String userAgent) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 84
2025-07-10 08:53:58.703 -03:00 [WRN] ⚠️ Falha ao criar lead para diogo@codigocentral.com.br, mas continuando com o processo
2025-07-10 08:53:58.711 -03:00 [INF] Iniciando cadastro de usuário na newsletter: diogo@codigocentral.com.br
2025-07-10 08:53:58.723 -03:00 [INF] Start processing HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 08:53:58.725 -03:00 [INF] Sending HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 08:53:59.660 -03:00 [INF] Received HTTP response headers after 932.3861ms - 200
2025-07-10 08:53:59.661 -03:00 [INF] End processing HTTP request after 939.0755ms - 200
2025-07-10 08:53:59.662 -03:00 [INF] Usuário cadastrado com sucesso na newsletter: diogo@codigocentral.com.br
2025-07-10 08:54:18.007 -03:00 [INF] ✅ Email enviado com sucesso para diogo@codigocentral.com.br - Assunto: Seu Manual da Primeira Virada está pronto para download!
2025-07-10 08:54:18.009 -03:00 [INF] 🔍 DEBUG CADASTRO - Email salvo no TempData: 'diogo@codigocentral.com.br'
2025-07-10 08:54:18.010 -03:00 [INF] 🔍 DEBUG CADASTRO - Nome salvo no TempData: 'Diogo'
2025-07-10 08:54:18.010 -03:00 [INF] Usuário Diogo (diogo@codigocentral.com.br) se cadastrou para receber o Manual da Primeira Virada
2025-07-10 08:54:18.014 -03:00 [INF] Executing RedirectResult, redirecting to /obrigado-desbloqueio.
2025-07-10 08:54:18.015 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev) in 23365.6872ms
2025-07-10 08:54:18.016 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 08:54:18.020 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - 302 0 null 23382.0712ms
2025-07-10 08:54:18.023 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - null null
2025-07-10 08:54:18.025 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 08:54:18.026 -03:00 [INF] Route matched with {action = "Obrigado", controller = "Desbloqueio"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Obrigado() on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 08:54:18.033 -03:00 [INF] 🔍 DEBUG OBRIGADO - Email recuperado do TempData: 'diogo@codigocentral.com.br'
2025-07-10 08:54:18.034 -03:00 [INF] 🔍 DEBUG OBRIGADO - Nome recuperado do TempData: 'Diogo'
2025-07-10 08:54:18.037 -03:00 [INF] Executing ViewResult, running view Obrigado.
2025-07-10 08:54:18.041 -03:00 [INF] Executed ViewResult - view Obrigado executed in 4.0448ms.
2025-07-10 08:54:18.042 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev) in 13.7117ms
2025-07-10 08:54:18.043 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 08:54:18.045 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - 200 null text/html; charset=utf-8 21.8085ms
2025-07-10 09:04:38.401 -03:00 [INF] Sistema iniciado em 10/07/2025 09:04:38
2025-07-10 09:04:38.472 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 09:04:38.475 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 09:04:38.476 -03:00 [INF] Hosting environment: Development
2025-07-10 09:04:38.476 -03:00 [INF] Content root path: f:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 09:05:12.215 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/manual-primeira-virada?id=5290c3db-235f-4029-88f7-de7cb8bd8514&vscodeBrowserReqId=1752149112181 - null null
2025-07-10 09:05:12.251 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/manual-primeira-virada?id=5290c3db-235f-4029-88f7-de7cb8bd8514&vscodeBrowserReqId=1752149112181 - 404 0 null 36.0659ms
2025-07-10 09:05:12.267 -03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/manual-primeira-virada, Response status code: 404
2025-07-10 09:05:39.032 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/desafio-vendas?id=6db18142-0a6d-4307-9ced-70a151bf250c&vscodeBrowserReqId=1752149139026 - null null
2025-07-10 09:05:39.037 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesafiosController.Index (site.diogocosta.dev)'
2025-07-10 09:05:39.055 -03:00 [INF] Route matched with {action = "Index", controller = "Desafios"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index(System.String) on controller site.diogocosta.dev.Controllers.DesafiosController (site.diogocosta.dev).
2025-07-10 09:05:39.153 -03:00 [INF] Executing ViewResult, running view Index.
2025-07-10 09:05:39.197 -03:00 [INF] Executed ViewResult - view Index executed in 45.7002ms.
2025-07-10 09:05:39.199 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesafiosController.Index (site.diogocosta.dev) in 141.8195ms
2025-07-10 09:05:39.201 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesafiosController.Index (site.diogocosta.dev)'
2025-07-10 09:05:39.205 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/desafio-vendas?id=6db18142-0a6d-4307-9ced-70a151bf250c&vscodeBrowserReqId=1752149139026 - 200 null text/html; charset=utf-8 173.8785ms
2025-07-10 09:06:04.187 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/leads/health - null null
2025-07-10 09:06:04.190 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev)'
2025-07-10 09:06:04.192 -03:00 [INF] Route matched with {action = "Health", controller = "Leads"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Health() on controller site.diogocosta.dev.Controllers.LeadsController (site.diogocosta.dev).
2025-07-10 09:06:04.198 -03:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType14`4[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-10 09:06:04.212 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev) in 18.961ms
2025-07-10 09:06:04.213 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev)'
2025-07-10 09:06:04.214 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/leads/health - 200 null application/json; charset=utf-8 26.5299ms
2025-07-10 09:06:19.275 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Desafios/CapturarLead - application/x-www-form-urlencoded 61
2025-07-10 09:06:19.276 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesafiosController.CapturarLead (site.diogocosta.dev)'
2025-07-10 09:06:19.283 -03:00 [INF] Route matched with {action = "CapturarLead", controller = "Desafios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CapturarLead(site.diogocosta.dev.Models.DesafioLeadModel) on controller site.diogocosta.dev.Controllers.DesafiosController (site.diogocosta.dev).
2025-07-10 09:06:19.610 -03:00 [ERR] Erro ao criar lead: teste@exemplo.com para desafio-vendas
System.InvalidOperationException: The 'string' property 'LeadInteractionModel.IpAddress' could not be mapped to the database type 'inet' because the database provider does not support mapping 'string' properties to 'inet' columns. Consider mapping to a different database type or converting the property value to a type supported by the database using a value converter. See https://aka.ms/efcore-docs-value-converters for more information. Alternately, exclude the property from the model using the '[NotMapped]' attribute or by using 'EntityTypeBuilder.Ignore' in 'OnModelCreating'.
   at Microsoft.EntityFrameworkCore.Infrastructure.RelationalModelValidator.ThrowPropertyNotMappedException(String propertyType, IConventionTypeBase typeBase, IConventionProperty unmappedProperty)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelValidator.<ValidatePropertyMapping>g__Validate|7_0(IConventionTypeBase typeBase, <>c__DisplayClass7_0&)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelValidator.ValidatePropertyMapping(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.RelationalModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Infrastructure.Internal.NpgsqlModelValidator.Validate(IModel model, IDiagnosticsLogger`1 logger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelRuntimeInitializer.Initialize(IModel model, Boolean designTime, IDiagnosticsLogger`1 validationLogger)
   at Microsoft.EntityFrameworkCore.Infrastructure.ModelSource.GetModel(DbContext context, ModelCreationDependencies modelCreationDependencies, Boolean designTime)
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.CreateModel(Boolean designTime)
   at Microsoft.EntityFrameworkCore.Internal.DbContextServices.get_Model()
   at Microsoft.EntityFrameworkCore.Infrastructure.EntityFrameworkServicesBuilder.<>c.<TryAddCoreServices>b__8_4(IServiceProvider p)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.get_ContextServices()
   at Microsoft.EntityFrameworkCore.DbContext.get_Model()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityType()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.CheckState()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.get_EntityQueryable()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.System.Linq.IQueryable.get_Provider()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.Include[TEntity,TProperty](IQueryable`1 source, Expression`1 navigationPropertyPath)
   at site.diogocosta.dev.Servicos.LeadService.BuscarLeadAsync(String email, String desafioSlug) in f:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 112
   at site.diogocosta.dev.Servicos.LeadService.CriarLeadAsync(CriarLeadRequest request, String ipAddress, String userAgent) in f:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 40
2025-07-10 09:06:19.623 -03:00 [ERR] Falha ao criar lead: teste@exemplo.com para desafio-vendas
2025-07-10 09:06:19.624 -03:00 [ERR] Erro ao capturar lead: teste@exemplo.com para desafio-vendas
System.Exception: Falha ao processar lead
   at site.diogocosta.dev.Controllers.DesafiosController.CapturarLead(DesafioLeadModel model) in f:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Controllers\DesafiosController.cs:line 217
2025-07-10 09:06:19.626 -03:00 [INF] Executing ViewResult, running view Index.
2025-07-10 09:06:19.630 -03:00 [INF] Executed ViewResult - view Index executed in 4.0367ms.
2025-07-10 09:06:19.631 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesafiosController.CapturarLead (site.diogocosta.dev) in 345.9243ms
2025-07-10 09:06:19.632 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesafiosController.CapturarLead (site.diogocosta.dev)'
2025-07-10 09:06:19.633 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Desafios/CapturarLead - 200 null text/html; charset=utf-8 358.9675ms
2025-07-10 09:14:14.907 -03:00 [INF] Sistema iniciado em 10/07/2025 09:14:14
2025-07-10 09:14:14.973 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 09:14:14.976 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 09:14:14.977 -03:00 [INF] Hosting environment: Development
2025-07-10 09:14:14.978 -03:00 [INF] Content root path: F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 09:14:50.641 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/leads - application/json 98
2025-07-10 09:14:50.667 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/leads - 404 0 null 26.6886ms
2025-07-10 09:14:50.679 -03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:5000/api/leads, Response status code: 404
2025-07-10 09:15:45.682 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/leads/health - null null
2025-07-10 09:15:45.686 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev)'
2025-07-10 09:15:45.700 -03:00 [INF] Route matched with {action = "Health", controller = "Leads"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Health() on controller site.diogocosta.dev.Controllers.LeadsController (site.diogocosta.dev).
2025-07-10 09:15:45.766 -03:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType14`4[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-10 09:15:45.781 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev) in 78.2514ms
2025-07-10 09:15:45.782 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.LeadsController.Health (site.diogocosta.dev)'
2025-07-10 09:15:45.784 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/api/leads/health - 200 null application/json; charset=utf-8 102.3789ms
2025-07-10 09:15:56.374 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - application/x-www-form-urlencoded 51
2025-07-10 09:15:56.377 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 09:15:56.389 -03:00 [INF] Route matched with {action = "Cadastrar", controller = "Desbloqueio"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Cadastrar(site.diogocosta.dev.Models.DesbloqueioModel) on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 09:15:56.411 -03:00 [INF] 🔄 INICIANDO PROCESSO DE CADASTRO - Email: diogo@codigocentral.com.br, Nome: Diogo Costa
2025-07-10 09:15:56.416 -03:00 [INF] 🔍 DADOS CAPTURADOS - IP: ::1, UserAgent: Mozilla/5.0 (Windows NT; Windows NT 10.0; pt-BR) WindowsPowerShell/5.1.26100.4652
2025-07-10 09:15:56.417 -03:00 [INF] 🔍 UTM PARAMETERS - Source: , Medium: , Campaign: 
2025-07-10 09:15:56.418 -03:00 [INF] 🚀 CHAMANDO _leadService.CriarLeadAsync - Email: diogo@codigocentral.com.br, Slug: manual-primeira-virada
2025-07-10 09:15:56.745 -03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-10 09:15:59.308 -03:00 [INF] Executed DbCommand (293ms) [Parameters=[@__ToLower_0='diogo@codigocentral.com.br', @__desafioSlug_1='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.created_at, l.desafio_slug, l.email, l.ip_address, l.nome, l.notas, l.opt_in, l.source_id, l.status, l.tags, l.updated_at, l.user_agent, l.utm_campaign, l.utm_content, l.utm_medium, l.utm_source, l.utm_term, l0.id, l0.ativo, l0.created_at, l0.descricao, l0.nome, l0.slug, l0.updated_at
FROM leads_system.leads AS l
LEFT JOIN leads_system.lead_sources AS l0 ON l.source_id = l0.id
WHERE l.email = @__ToLower_0 AND l.desafio_slug = @__desafioSlug_1
LIMIT 1
2025-07-10 09:15:59.627 -03:00 [INF] Executed DbCommand (264ms) [Parameters=[@__8__locals1_request_DesafioSlug_0='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.ativo, l.created_at, l.descricao, l.nome, l.slug, l.updated_at
FROM leads_system.lead_sources AS l
WHERE l.slug = @__8__locals1_request_DesafioSlug_0
LIMIT 1
2025-07-10 09:16:00.025 -03:00 [INF] Executed DbCommand (274ms) [Parameters=[@p0='2025-07-10T12:15:59.7140875Z' (DbType = DateTime), @p1='manual-primeira-virada' (Nullable = false), @p2='diogo@codigocentral.com.br' (Nullable = false), @p3='::1' (DbType = Object), @p4='Diogo Costa' (Nullable = false), @p5=NULL, @p6='True', @p7='9' (Nullable = true), @p8='novo' (Nullable = false), @p9=NULL (DbType = Object), @p10='2025-07-10T12:15:59.7141140Z' (DbType = DateTime), @p11='Mozilla/5.0 (Windows NT; Windows NT 10.0; pt-BR) WindowsPowerShell/5.1.26100.4652', @p12=NULL, @p13=NULL, @p14=NULL, @p15=NULL, @p16=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.leads (created_at, desafio_slug, email, ip_address, nome, notas, opt_in, source_id, status, tags, updated_at, user_agent, utm_campaign, utm_content, utm_medium, utm_source, utm_term)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16)
RETURNING id;
2025-07-10 09:16:00.328 -03:00 [ERR] Failed executing DbCommand (266ms) [Parameters=[@p0='2025-07-10T12:16:00.0471053Z' (DbType = DateTime), @p1='{"desafio":"manual-primeira-virada","utm_source":null,"utm_medium":null,"utm_campaign":null}', @p2='Lead se cadastrou no desafio', @p3=NULL (DbType = Object), @p4='1', @p5='form_submitted' (Nullable = false), @p6=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.lead_interactions (created_at, dados, descricao, ip_address, lead_id, tipo, user_agent)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING id;
2025-07-10 09:16:00.338 -03:00 [ERR] An exception occurred in the database while saving changes for context type 'site.diogocosta.dev.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-10 09:16:00.348 -03:00 [ERR] Erro ao registrar interação para lead 1: form_submitted
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at site.diogocosta.dev.Data.ApplicationDbContext.SaveChangesAsync(CancellationToken cancellationToken) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Data\ApplicationDbContext.cs:line 199
   at site.diogocosta.dev.Servicos.LeadService.RegistrarInteracaoAsync(Int32 leadId, String tipo, String descricao, Object dados) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 155
2025-07-10 09:16:00.357 -03:00 [INF] Novo lead criado: diogo@codigocentral.com.br para manual-primeira-virada (ID: 1)
2025-07-10 09:16:00.358 -03:00 [INF] 💰 Lead criado com sucesso para Manual da Primeira Virada: diogo@codigocentral.com.br (ID: 1)
2025-07-10 09:16:00.361 -03:00 [INF] Iniciando cadastro de usuário na newsletter: diogo@codigocentral.com.br
2025-07-10 09:16:00.364 -03:00 [INF] Start processing HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 09:16:00.366 -03:00 [INF] Sending HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 09:16:01.284 -03:00 [INF] Received HTTP response headers after 916.0114ms - 200
2025-07-10 09:16:01.285 -03:00 [INF] End processing HTTP request after 922.7759ms - 200
2025-07-10 09:16:01.286 -03:00 [INF] Usuário cadastrado com sucesso na newsletter: diogo@codigocentral.com.br
2025-07-10 09:16:13.198 -03:00 [INF] ✅ Email enviado com sucesso para diogo@codigocentral.com.br - Assunto: 🔥 Diogo Costa, seu lugar no Manual Primeira Virada está garantido!
2025-07-10 09:16:13.506 -03:00 [INF] Executed DbCommand (276ms) [Parameters=[@p0=NULL (DbType = DateTime), @p1='🔥 Diogo Costa, seu lugar no Manual Primeira Virada está garantido!' (Nullable = false), @p2=NULL (DbType = DateTime), @p3=NULL (DbType = DateTime), @p4='diogo@codigocentral.com.br' (Nullable = false), @p5='2025-07-10T12:16:13.2008851Z' (DbType = DateTime), @p6=NULL, @p7='1' (Nullable = true), @p8=NULL (DbType = DateTime), @p9='enviado' (Nullable = false), @p10='1' (Nullable = true), @p11='2025-07-10T12:16:00.0471053Z' (DbType = DateTime), @p12='{"desafio":"manual-primeira-virada","utm_source":null,"utm_medium":null,"utm_campaign":null}', @p13='Lead se cadastrou no desafio', @p14=NULL (DbType = Object), @p15='1', @p16='form_submitted' (Nullable = false), @p17=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.email_logs (aberto_em, assunto, bounce_em, clicado_em, email_to, enviado_em, erro_msg, lead_id, spam_em, status, template_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
INSERT INTO leads_system.lead_interactions (created_at, dados, descricao, ip_address, lead_id, tipo, user_agent)
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17)
RETURNING id;
2025-07-10 09:16:13.781 -03:00 [ERR] An exception occurred in the database while saving changes for context type 'site.diogocosta.dev.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-10 09:16:13.788 -03:00 [ERR] Erro ao enviar email de boas-vindas para lead 1
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 42804: column "dados" is of type jsonb but expression is of type text

POSITION: 127
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 42804
    MessageText: column "dados" is of type jsonb but expression is of type text
    Hint: You will need to rewrite or cast the expression.
    Position: 127
    File: parse_target.c
    Line: 587
    Routine: transformAssignedExpr
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Update.Internal.NpgsqlModificationCommandBatch.Consume(RelationalDataReader reader, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at site.diogocosta.dev.Data.ApplicationDbContext.SaveChangesAsync(CancellationToken cancellationToken) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Data\ApplicationDbContext.cs:line 199
   at site.diogocosta.dev.Servicos.LeadService.EnviarEmailBoasVindasAsync(LeadModel lead) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 250
2025-07-10 09:16:14.407 -03:00 [INF] ✅ Email enviado com sucesso para diogo@codigocentral.com.br - Assunto: Seu Manual da Primeira Virada está pronto para download!
2025-07-10 09:16:14.409 -03:00 [INF] 🔍 DEBUG CADASTRO - Email salvo no TempData: 'diogo@codigocentral.com.br'
2025-07-10 09:16:14.409 -03:00 [INF] 🔍 DEBUG CADASTRO - Nome salvo no TempData: 'Diogo Costa'
2025-07-10 09:16:14.410 -03:00 [INF] Usuário Diogo Costa (diogo@codigocentral.com.br) se cadastrou para receber o Manual da Primeira Virada
2025-07-10 09:16:14.421 -03:00 [INF] Executing RedirectResult, redirecting to /obrigado-desbloqueio.
2025-07-10 09:16:14.424 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev) in 18033.6036ms
2025-07-10 09:16:14.425 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 09:16:14.429 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - 302 0 null 18055.0211ms
2025-07-10 09:16:14.431 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - application/x-www-form-urlencoded null
2025-07-10 09:16:14.433 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 09:16:14.434 -03:00 [INF] Route matched with {action = "Obrigado", controller = "Desbloqueio"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Obrigado() on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 09:16:14.441 -03:00 [INF] 🔍 DEBUG OBRIGADO - Email recuperado do TempData: 'diogo@codigocentral.com.br'
2025-07-10 09:16:14.442 -03:00 [INF] 🔍 DEBUG OBRIGADO - Nome recuperado do TempData: 'Diogo Costa'
2025-07-10 09:16:14.464 -03:00 [INF] Executing ViewResult, running view Obrigado.
2025-07-10 09:16:14.514 -03:00 [INF] Executed ViewResult - view Obrigado executed in 51.8727ms.
2025-07-10 09:16:14.515 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev) in 80.2692ms
2025-07-10 09:16:14.516 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 09:16:14.517 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - 200 null text/html; charset=utf-8 86.2659ms
2025-07-10 09:18:29.329 -03:00 [INF] Sistema iniciado em 10/07/2025 09:18:29
2025-07-10 09:18:29.393 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 09:18:29.396 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 09:18:29.397 -03:00 [INF] Hosting environment: Development
2025-07-10 09:18:29.397 -03:00 [INF] Content root path: F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 09:18:41.486 -03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - application/x-www-form-urlencoded 57
2025-07-10 09:18:41.517 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 09:18:41.537 -03:00 [INF] Route matched with {action = "Cadastrar", controller = "Desbloqueio"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Cadastrar(site.diogocosta.dev.Models.DesbloqueioModel) on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 09:18:41.618 -03:00 [INF] 🔄 INICIANDO PROCESSO DE CADASTRO - Email: teste.final@codigocentral.com.br, Nome: Teste Final
2025-07-10 09:18:41.624 -03:00 [INF] 🔍 DADOS CAPTURADOS - IP: ::1, UserAgent: Mozilla/5.0 (Windows NT; Windows NT 10.0; pt-BR) WindowsPowerShell/5.1.26100.4652
2025-07-10 09:18:41.625 -03:00 [INF] 🔍 UTM PARAMETERS - Source: , Medium: , Campaign: 
2025-07-10 09:18:41.626 -03:00 [INF] 🚀 CHAMANDO _leadService.CriarLeadAsync - Email: teste.final@codigocentral.com.br, Slug: manual-primeira-virada
2025-07-10 09:18:41.958 -03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-07-10 09:18:44.602 -03:00 [INF] Executed DbCommand (297ms) [Parameters=[@__ToLower_0='teste.final@codigocentral.com.br', @__desafioSlug_1='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.created_at, l.desafio_slug, l.email, l.ip_address, l.nome, l.notas, l.opt_in, l.source_id, l.status, l.tags, l.updated_at, l.user_agent, l.utm_campaign, l.utm_content, l.utm_medium, l.utm_source, l.utm_term, l0.id, l0.ativo, l0.created_at, l0.descricao, l0.nome, l0.slug, l0.updated_at
FROM leads_system.leads AS l
LEFT JOIN leads_system.lead_sources AS l0 ON l.source_id = l0.id
WHERE l.email = @__ToLower_0 AND l.desafio_slug = @__desafioSlug_1
LIMIT 1
2025-07-10 09:18:44.928 -03:00 [INF] Executed DbCommand (267ms) [Parameters=[@__8__locals1_request_DesafioSlug_0='manual-primeira-virada'], CommandType='"Text"', CommandTimeout='30']
SELECT l.id, l.ativo, l.created_at, l.descricao, l.nome, l.slug, l.updated_at
FROM leads_system.lead_sources AS l
WHERE l.slug = @__8__locals1_request_DesafioSlug_0
LIMIT 1
2025-07-10 09:18:45.329 -03:00 [INF] Executed DbCommand (274ms) [Parameters=[@p0='2025-07-10T12:18:45.0181161Z' (DbType = DateTime), @p1='manual-primeira-virada' (Nullable = false), @p2='teste.final@codigocentral.com.br' (Nullable = false), @p3='::1' (DbType = Object), @p4='Teste Final' (Nullable = false), @p5=NULL, @p6='True', @p7='9' (Nullable = true), @p8='novo' (Nullable = false), @p9=NULL (DbType = Object), @p10='2025-07-10T12:18:45.0181396Z' (DbType = DateTime), @p11='Mozilla/5.0 (Windows NT; Windows NT 10.0; pt-BR) WindowsPowerShell/5.1.26100.4652', @p12=NULL, @p13=NULL, @p14=NULL, @p15=NULL, @p16=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.leads (created_at, desafio_slug, email, ip_address, nome, notas, opt_in, source_id, status, tags, updated_at, user_agent, utm_campaign, utm_content, utm_medium, utm_source, utm_term)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16)
RETURNING id;
2025-07-10 09:18:45.647 -03:00 [INF] Executed DbCommand (281ms) [Parameters=[@p0='2025-07-10T12:18:45.3440426Z' (DbType = DateTime), @p1='System.Text.Json.JsonDocument' (DbType = Object), @p2='Lead se cadastrou no desafio', @p3=NULL (DbType = Object), @p4='2', @p5='form_submitted' (Nullable = false), @p6=NULL], CommandType='"Text"', CommandTimeout='30']
INSERT INTO leads_system.lead_interactions (created_at, dados, descricao, ip_address, lead_id, tipo, user_agent)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING id;
2025-07-10 09:18:45.651 -03:00 [INF] Novo lead criado: teste.final@codigocentral.com.br para manual-primeira-virada (ID: 2)
2025-07-10 09:18:45.652 -03:00 [INF] 💰 Lead criado com sucesso para Manual da Primeira Virada: teste.final@codigocentral.com.br (ID: 2)
2025-07-10 09:18:45.654 -03:00 [INF] Iniciando cadastro de usuário na newsletter: teste.final@codigocentral.com.br
2025-07-10 09:18:45.658 -03:00 [INF] Start processing HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 09:18:45.660 -03:00 [INF] Sending HTTP request POST https://n8n.diogocosta.dev/webhook/colocar-na-lista
2025-07-10 09:18:45.923 -03:00 [INF] Executed DbCommand (264ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.assunto, e.ativo, e.corpo_html, e.corpo_texto, e.created_at, e.nome, e.slug, e.updated_at, e.variaveis
FROM leads_system.email_templates AS e
WHERE e.slug = 'boas-vindas-desafio' AND e.ativo
LIMIT 1
2025-07-10 09:18:46.550 -03:00 [INF] Received HTTP response headers after 888.446ms - 200
2025-07-10 09:18:46.555 -03:00 [INF] End processing HTTP request after 897.7009ms - 200
2025-07-10 09:18:46.556 -03:00 [INF] Usuário cadastrado com sucesso na newsletter: teste.final@codigocentral.com.br
2025-07-10 09:18:52.679 -03:00 [INF] ✅ Email enviado com sucesso para teste.final@codigocentral.com.br - Assunto: Seu Manual da Primeira Virada está pronto para download!
2025-07-10 09:18:52.681 -03:00 [INF] 🔍 DEBUG CADASTRO - Email salvo no TempData: 'teste.final@codigocentral.com.br'
2025-07-10 09:18:52.682 -03:00 [INF] 🔍 DEBUG CADASTRO - Nome salvo no TempData: 'Teste Final'
2025-07-10 09:18:52.683 -03:00 [INF] Usuário Teste Final (teste.final@codigocentral.com.br) se cadastrou para receber o Manual da Primeira Virada
2025-07-10 09:18:52.695 -03:00 [INF] Executing RedirectResult, redirecting to /obrigado-desbloqueio.
2025-07-10 09:18:52.699 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev) in 11159.0151ms
2025-07-10 09:18:52.700 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Cadastrar (site.diogocosta.dev)'
2025-07-10 09:18:52.707 -03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Desbloqueio/Cadastrar - 302 0 null 11221.278ms
2025-07-10 09:18:52.709 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - application/x-www-form-urlencoded null
2025-07-10 09:18:52.712 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 09:18:52.714 -03:00 [INF] Route matched with {action = "Obrigado", controller = "Desbloqueio"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Obrigado() on controller site.diogocosta.dev.Controllers.DesbloqueioController (site.diogocosta.dev).
2025-07-10 09:18:52.720 -03:00 [INF] 🔍 DEBUG OBRIGADO - Email recuperado do TempData: 'teste.final@codigocentral.com.br'
2025-07-10 09:18:52.721 -03:00 [INF] 🔍 DEBUG OBRIGADO - Nome recuperado do TempData: 'Teste Final'
2025-07-10 09:18:52.744 -03:00 [INF] Executing ViewResult, running view Obrigado.
2025-07-10 09:18:52.805 -03:00 [INF] Executed ViewResult - view Obrigado executed in 63.4449ms.
2025-07-10 09:18:52.806 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev) in 91.1246ms
2025-07-10 09:18:52.807 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.DesbloqueioController.Obrigado (site.diogocosta.dev)'
2025-07-10 09:18:52.808 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/obrigado-desbloqueio - 200 null text/html; charset=utf-8 99.2151ms
2025-07-10 09:18:53.916 -03:00 [INF] ✅ Email enviado com sucesso para teste.final@codigocentral.com.br - Assunto: 🔥 Teste Final, seu lugar no Manual Primeira Virada está garantido!
2025-07-10 09:18:53.930 -03:00 [ERR] Erro ao enviar email de boas-vindas para lead 2
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'ApplicationDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Internal.IDbContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.EntryWithoutDetectChanges(TEntity entity)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Add(TEntity entity)
   at site.diogocosta.dev.Servicos.LeadService.EnviarEmailBoasVindasAsync(LeadModel lead) in F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\Servicos\LeadService.cs:line 249
2025-07-10 19:01:41.087 -03:00 [INF] Sistema iniciado em 10/07/2025 19:01:41
2025-07-10 19:01:41.167 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 19:01:41.171 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 19:01:41.172 -03:00 [INF] Hosting environment: Development
2025-07-10 19:01:41.172 -03:00 [INF] Content root path: F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 19:14:13.235 -03:00 [INF] Application is shutting down...
2025-07-10 19:17:01.501 -03:00 [INF] Sistema iniciado em 10/07/2025 19:17:01
2025-07-10 19:17:01.590 -03:00 [INF] Now listening on: http://localhost:5000
2025-07-10 19:17:01.593 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-10 19:17:01.594 -03:00 [INF] Hosting environment: Development
2025-07-10 19:17:01.594 -03:00 [INF] Content root path: F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev
2025-07-10 19:17:07.032 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-07-10 19:17:07.081 -03:00 [INF] Executing endpoint 'site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev)'
2025-07-10 19:17:07.099 -03:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller site.diogocosta.dev.Controllers.HomeController (site.diogocosta.dev).
2025-07-10 19:17:07.116 -03:00 [INF] Executing ViewResult, running view Index.
2025-07-10 19:17:07.237 -03:00 [INF] Executed ViewResult - view Index executed in 122.1113ms.
2025-07-10 19:17:07.249 -03:00 [INF] Executed action site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev) in 147.8211ms
2025-07-10 19:17:07.251 -03:00 [INF] Executed endpoint 'site.diogocosta.dev.Controllers.HomeController.Index (site.diogocosta.dev)'
2025-07-10 19:17:07.254 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 223.2125ms
2025-07-10 19:17:07.318 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/IMG_0045.webp - null null
2025-07-10 19:17:07.319 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/newsletter.js - null null
2025-07-10 19:17:07.334 -03:00 [INF] Sending file. Request path: '/img/IMG_0045.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\IMG_0045.webp'
2025-07-10 19:17:07.334 -03:00 [INF] Sending file. Request path: '/js/newsletter.js'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\js\newsletter.js'
2025-07-10 19:17:07.337 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/IMG_0045.webp - 200 43926 image/webp 19.1526ms
2025-07-10 19:17:07.338 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/newsletter.js - 200 5883 text/javascript 18.8734ms
2025-07-10 19:17:07.616 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/1.webp - null null
2025-07-10 19:17:07.616 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/6.webp - null null
2025-07-10 19:17:07.618 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/4.webp - null null
2025-07-10 19:17:07.618 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/3.webp - null null
2025-07-10 19:17:07.619 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/5.webp - null null
2025-07-10 19:17:07.619 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/7.webp - null null
2025-07-10 19:17:07.620 -03:00 [INF] Sending file. Request path: '/img/1.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\1.webp'
2025-07-10 19:17:07.622 -03:00 [INF] Sending file. Request path: '/img/6.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\6.webp'
2025-07-10 19:17:07.626 -03:00 [INF] Sending file. Request path: '/img/4.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\4.webp'
2025-07-10 19:17:07.629 -03:00 [INF] Sending file. Request path: '/img/3.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\3.webp'
2025-07-10 19:17:07.631 -03:00 [INF] Sending file. Request path: '/img/5.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\5.webp'
2025-07-10 19:17:07.634 -03:00 [INF] Sending file. Request path: '/img/7.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\7.webp'
2025-07-10 19:17:07.636 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/1.webp - 200 6562 image/webp 19.8384ms
2025-07-10 19:17:07.637 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/6.webp - 200 7306 image/webp 20.824ms
2025-07-10 19:17:07.638 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/4.webp - 200 8996 image/webp 20.402ms
2025-07-10 19:17:07.639 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/3.webp - 200 4492 image/webp 21.4859ms
2025-07-10 19:17:07.641 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/5.webp - 200 8740 image/webp 22.1091ms
2025-07-10 19:17:07.643 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/7.webp - 200 4522 image/webp 23.6233ms
2025-07-10 19:17:07.646 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/8.webp - null null
2025-07-10 19:17:07.649 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/13.webp - null null
2025-07-10 19:17:07.652 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/11.webp - null null
2025-07-10 19:17:07.655 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/12.webp - null null
2025-07-10 19:17:07.658 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/9.webp - null null
2025-07-10 19:17:07.662 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/10.webp - null null
2025-07-10 19:17:07.666 -03:00 [INF] Sending file. Request path: '/img/8.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\8.webp'
2025-07-10 19:17:07.669 -03:00 [INF] Sending file. Request path: '/img/13.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\13.webp'
2025-07-10 19:17:07.672 -03:00 [INF] Sending file. Request path: '/img/11.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\11.webp'
2025-07-10 19:17:07.675 -03:00 [INF] Sending file. Request path: '/img/12.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\12.webp'
2025-07-10 19:17:07.678 -03:00 [INF] Sending file. Request path: '/img/9.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\9.webp'
2025-07-10 19:17:07.681 -03:00 [INF] Sending file. Request path: '/img/10.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\10.webp'
2025-07-10 19:17:07.682 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/8.webp - 200 11264 image/webp 35.9474ms
2025-07-10 19:17:07.683 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/13.webp - 200 9486 image/webp 34.2833ms
2025-07-10 19:17:07.685 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/11.webp - 200 5346 image/webp 33.4738ms
2025-07-10 19:17:07.687 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/12.webp - 200 4880 image/webp 31.8704ms
2025-07-10 19:17:07.689 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/9.webp - 200 13526 image/webp 30.2937ms
2025-07-10 19:17:07.690 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/10.webp - 200 7788 image/webp 27.7444ms
2025-07-10 19:17:07.693 -03:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/img/14.webp - null null
2025-07-10 19:17:07.713 -03:00 [INF] Sending file. Request path: '/img/14.webp'. Physical path: 'F:\Projetos\Serviço de Pagamento\site.diogocosta.dev\site.diogocosta.dev\wwwroot\img\14.webp'
2025-07-10 19:17:07.714 -03:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/img/14.webp - 200 7290 image/webp 21.0366ms
